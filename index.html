<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
  <meta name="description" content="StrongToby - Toby的病历记录与健康追踪">
  <meta name="theme-color" content="#6B9B7B">
  <title>StrongToby - Toby的病历记录</title>

  <!-- Favicon: dog paw emoji -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🐾</text></svg>">

  <!-- Stylesheets -->
  <link rel="stylesheet" href="css/style.css">

  <!-- Chart.js + adapters from CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.1.0/dist/chartjs-plugin-annotation.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked@15.0.7/marked.min.js"></script>
</head>
<body>

  <!-- ===== Mobile header bar ===== -->
  <header class="mobile-header" id="mobileHeader">
    <button class="hamburger-btn" id="hamburgerBtn" aria-label="打开导航菜单" aria-expanded="false" aria-controls="sidebar">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
    <h1 class="mobile-header__title">
      <span class="mobile-header__icon">🐾</span>
      StrongToby
    </h1>
  </header>

  <!-- ===== Sidebar overlay (mobile) ===== -->
  <div class="sidebar-overlay" id="sidebarOverlay"></div>

  <!-- ===== Sidebar navigation ===== -->
  <aside class="sidebar" id="sidebar" role="navigation" aria-label="主导航">
    <!-- Sidebar header / pet info -->
    <div class="sidebar__header">
      <div class="sidebar__brand">
        <span class="sidebar__brand-icon">🐾</span>
        <div class="sidebar__brand-text">
          <h1 class="sidebar__title">StrongToby</h1>
          <p class="sidebar__subtitle" id="petSubtitle">柯基 Toby 的病历</p>
        </div>
      </div>
      <button class="sidebar__collapse-btn" id="collapseBtn" aria-label="收起侧边栏" title="收起侧边栏">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
      </button>
    </div>

    <!-- Navigation list (dynamically populated by app.js) -->
    <nav class="sidebar__nav" id="sidebarNav">
      <ul class="nav-list" id="navList">
        <!-- Static fallback structure; app.js will regenerate from reports-index.json -->
        <li class="nav-item nav-item--active" data-route="overview">
          <a href="#overview" class="nav-link">
            <span class="nav-icon">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
            </span>
            <span class="nav-label">概览</span>
          </a>
        </li>

        <li class="nav-item nav-item--has-children" data-route="imaging">
          <a href="#imaging" class="nav-link">
            <span class="nav-icon">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="2"/><circle cx="12" cy="12" r="3"/><path d="M2 12h4M18 12h4M12 2v4M12 18v4"/></svg>
            </span>
            <span class="nav-label">影像报告</span>
            <span class="nav-chevron">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
            </span>
          </a>
          <ul class="nav-sublist" id="navImagingList">
            <!-- Sub-groups: CT, B超, X光 — populated by app.js -->
            <li class="nav-subgroup">
              <span class="nav-subgroup__label">CT</span>
              <ul class="nav-subgroup__items" id="navCtItems"></ul>
            </li>
            <li class="nav-subgroup">
              <span class="nav-subgroup__label">B超</span>
              <ul class="nav-subgroup__items" id="navUltrasoundItems"></ul>
            </li>
            <li class="nav-subgroup">
              <span class="nav-subgroup__label">X光</span>
              <ul class="nav-subgroup__items" id="navXrayItems"></ul>
            </li>
          </ul>
        </li>

        <li class="nav-item nav-item--has-children" data-route="pathology">
          <a href="#pathology" class="nav-link">
            <span class="nav-icon">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 2h6v2H9zM12 10v4M10 12h4"/><rect x="5" y="4" width="14" height="18" rx="2"/></svg>
            </span>
            <span class="nav-label">病理报告</span>
            <span class="nav-chevron">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
            </span>
          </a>
          <ul class="nav-sublist" id="navPathologyList">
            <!-- Biopsy, cytology, culture items + photos subgroup — populated by app.js -->
          </ul>
        </li>

        <li class="nav-item" data-route="bloodwork">
          <a href="#bloodwork" class="nav-link">
            <span class="nav-icon">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2C12 2 6 9 6 14a6 6 0 0 0 12 0c0-5-6-12-6-12z"/></svg>
            </span>
            <span class="nav-label">血常规 / 生化</span>
          </a>
        </li>

        <li class="nav-item" data-route="bp">
          <a href="#bp" class="nav-link">
            <span class="nav-icon">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
            </span>
            <span class="nav-label">血压 / 体重</span>
          </a>
        </li>

        <li class="nav-item" data-route="medications">
          <a href="#medications" class="nav-link">
            <span class="nav-icon">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="7" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
            </span>
            <span class="nav-label">服药记录</span>
          </a>
        </li>

        <li class="nav-item nav-item--has-children" data-route="archive">
          <a href="#archive" class="nav-link">
            <span class="nav-icon">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 8v13H3V8"/><rect x="1" y="3" width="22" height="5"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
            </span>
            <span class="nav-label">过往体检</span>
            <span class="nav-chevron">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
            </span>
          </a>
          <ul class="nav-sublist" id="navArchiveList">
            <!-- populated by app.js -->
          </ul>
        </li>
      </ul>
    </nav>

    <!-- Sidebar footer -->
    <div class="sidebar__footer">
      <p class="sidebar__footer-text">数据仅供家庭参考<br>请遵医嘱</p>
    </div>
  </aside>

  <!-- ===== Main content area ===== -->
  <main class="main-content" id="mainContent">
    <!-- Page content rendered here by JS router -->
    <div class="content-area" id="content">

      <!-- Loading state (shown before JS initializes) -->
      <div class="loading-state" id="loadingState">
        <div class="loading-spinner"></div>
        <p>加载中...</p>
      </div>

    </div>
  </main>

  <!-- ===== Image lightbox ===== -->
  <div class="lightbox" id="lightbox" role="dialog" aria-modal="true" aria-label="图片查看器" hidden>
    <button class="lightbox__close" id="lightboxClose" aria-label="关闭图片查看器">&times;</button>
    <div class="lightbox__body" id="lightboxBody">
      <img class="lightbox__img" id="lightboxImg" src="" alt="查看大图">
    </div>
    <div class="lightbox__controls">
      <button class="lightbox__zoom-in" id="lightboxZoomIn" aria-label="放大">+</button>
      <button class="lightbox__zoom-reset" id="lightboxZoomReset" aria-label="重置大小">1:1</button>
      <button class="lightbox__zoom-out" id="lightboxZoomOut" aria-label="缩小">&minus;</button>
    </div>
    <p class="lightbox__caption" id="lightboxCaption"></p>
  </div>

  <!-- ===== JS modules ===== -->
  <script src="js/app.js"></script>
  <script src="js/overview.js"></script>
  <script src="js/timeline.js"></script>
  <script src="js/report-viewer.js"></script>
  <script src="js/blood-work.js"></script>
  <script src="js/bp-weight-tracker.js"></script>
  <script src="js/medication.js"></script>

</body>
</html>
